<!doctype html>
<html>
<head>
  <title>{{user}}</title>
  
  {{> head}}
  
</head>
<body>
  <header>
    <h1 class="title">
      <a href="/" class="light">{{projectName}}</a>
    </h1>
    
    {{> search}}
    
  </header>

  <main>
    
    {{{body}}}
    
  </main>

  <footer>
    <a href="https://open.spotify.com/user/nntrn">annie tran</a>
  </footer>

  <script>
    let form = document.getElementById("getUser");

    form.addEventListener("submit", function(event) {
      event.preventDefault()
      window.location.pathname =`/user/${document.querySelector("#finduser").value}`
    })
  </script>
  <script>
    
    function query(params) {
      return (
        '?' +
        Object.entries(params)
          .map(e => `${e[0]}=${e[1]}`)
          .join('&')
      )
    }
    
    function getTracksApi(id){
      
      fetch(`/api/playlist/${id}/tracks${query({fields:'items(track(name,artists,popularity))'})}`)
      .then(data=> data.json())
      .then(d=>blah(id, d.items))
      
    }
    
    function blah(id, dat){
      
      const appe = Object.assign(document.createElement('div'),{
        textContent: JSON.stringify(dat,null,2),
        style:'white-space:pre;font-size:.9em'
      })
      
      document.querySelector(`#playlist-${id} .tracks .output`).appendChild(appe)
      document.querySelector(`#playlist-${id} .tracks button`).remove()
    }
</script>

</body>

</html>